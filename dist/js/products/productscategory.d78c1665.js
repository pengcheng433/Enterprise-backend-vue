import{D as j}from"../index/index.78072cb3.js";import{D as q}from"../index/index.41c9881b.js";import{M as R,B as S,P as z}from"../@element-plus/@element-plus.01e950e2.js";import{g as A,a as G,d as H,e as J,u as K,b as O}from"../productsCategory/productsCategory.4a144398.js";import{D as Q}from"../index/index.aae611ba.js";import{e as r,x as W,k as D,l as F,c as X,a4 as o,_ as p,u as n,an as s,a2 as f,o as Y,a as g}from"../@vue/@vue.133e0034.js";import{l as i}from"../element-plus/element-plus.8d403dde.js";import"../../assets/index-30bdac58.js";import"../pinia/pinia.dbd2d364.js";import"../js-cookie/js-cookie.cf83ad76.js";import"../axios/axios.aba6f0e0.js";import"../geotiff/geotiff.41c905a7.js";import"../vue-router/vue-router.aebc008a.js";import"../fuse.js/fuse.js.88e2763d.js";import"../path-browserify/path-browserify.188d1ff8.js";import"../screenfull/screenfull.b3e6dc1f.js";import"../mitt/mitt.f7ef348c.js";import"../lodash-es/lodash-es.3689fb67.js";import"../@vueuse/@vueuse.902d2a47.js";import"../@ctrl/@ctrl.739734d8.js";import"../nprogress/nprogress.71449f25.js";/* empty css                                 */import"../clipboard/clipboard.860bb701.js";import"../vue-i18n/vue-i18n.dbf743d6.js";import"../@intlify/@intlify.771bffe6.js";import"../xe-utils/xe-utils.ae8f073f.js";import"../vxe-table/vxe-table.548b57f4.js";import"../vue3-lottie/vue3-lottie.24ecfee7.js";import"../lottie-web/lottie-web.c7050559.js";import"../@popperjs/@popperjs.d5d3bfa4.js";import"../dayjs/dayjs.aab16a72.js";import"../async-validator/async-validator.124ce023.js";import"../memoize-one/memoize-one.e2e9ba7a.js";import"../escape-html/escape-html.1d60d822.js";import"../normalize-wheel-es/normalize-wheel-es.2d7fa0bb.js";import"../@floating-ui/@floating-ui.c244c5cb.js";import"../vue/vue.b7c74ca4.js";import"../lodash-unified/lodash-unified.917db8bb.js";import"../news/news.8f1b56e5.js";const Z={class:"common-layout"},$={class:"flex-row"},ee={class:"flex justify-end"},ze={__name:"productscategory",setup(te,{expose:M}){const _=r(!1);W(()=>{u()});const B=D(()=>a.id?"修改分类":"添加分类"),a=F({name:"",description:""}),E=r([{prop:"name",label:"分类名称",rules:[{required:!0,message:"必须输入分类名称",trigger:"blur"}]},{prop:"description",label:"备注",type:"textarea"}]),c=r(!1),u=async()=>{_.value=!0;const{data:e}=await A(y);_.value=!1,C.value=e},C=r([]),d=r(null),h=D(()=>{var e;return((e=d==null?void 0:d.value)==null?void 0:e.multipleSelection)||[]}),P=r([{type:"selection"},{prop:"id",label:"ID",width:80},{prop:"name",label:"分类名称"},{prop:"description",label:"备注"},{prop:"state",label:"状态",render:e=>o("div",null,[e.state==1?"启用":"禁用"])},{prop:"setting",label:"操作",render:e=>o("div",{class:"flex"},[o(s("el-button"),{type:"primary",onClick:()=>T(e)},{default:()=>[f("编辑")]}),e.state==1?o(s("el-button"),{type:"warning",onClick:()=>x(e)},{default:()=>[f("禁用")]}):o(s("el-button"),{type:"success",onClick:()=>x(e)},{default:()=>[f("启用")]}),o(s("el-button"),{type:"danger",onClick:()=>k(e)},{default:()=>[f("删除")]})])}]),w=r(""),V=async()=>{if(await w.value.form.validate())if(a.id){const t=await K(a);t.data&&(i.ElMessage({message:t.msg,type:"success"}),c.value=!1,u())}else{const t=await O(a);t.data?(i.ElMessage({message:t.msg,type:"success"}),c.value=!1,u()):i.ElMessage.error(t.msg)}},T=async e=>{const t=await G({id:e.id}),{id:l,name:m,description:b}=t.data;a.id=l,a.name=m,a.description=b,c.value=!0},k=e=>{const t=h.value.length>0?h.value.map(l=>l.id):[e.id];if(t.length==0||t[t.length-1]==null){i.ElMessage.warning("至少选中一条数据");return}i.ElMessageBox.confirm("确定要删除这些选中分类吗吗",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{(await H({ids:t})).code==200&&(i.ElMessage({type:"success",message:"删除成功"}),u())})},y=F({search:""}),x=async e=>{const{id:t}=e,l=await J({id:t});l.data&&(i.ElMessage({type:"success",message:l.msg}),u())},I=()=>{a.id="",a.name="",a.description="",c.value=!0};return M({tableItemSelectionRef:d}),(e,t)=>{const l=s("el-input"),m=s("el-button"),b=s("el-row"),N=s("el-header"),L=s("el-main"),U=s("el-container");return Y(),X("div",Z,[o(U,null,{default:p(()=>[o(N,{class:"h-auto"},{default:p(()=>[o(b,{class:"flex-row flex-between"},{default:p(()=>[g("div",$,[o(l,{class:"w-50",modelValue:y.search,"onUpdate:modelValue":t[0]||(t[0]=v=>y.search=v),placeholder:"输入标题"},null,8,["modelValue"]),o(m,{class:"ml-2",icon:n(R),circle:"",onClick:u},null,8,["icon"])]),g("div",null,[o(m,{type:"primary",icon:n(S),circle:"",onClick:I},null,8,["icon"]),o(m,{type:"danger",icon:n(z),circle:"",onClick:k},null,8,["icon"])])]),_:1})]),_:1}),o(L,null,{default:p(()=>[o(n(Q),{loading:_.value,ref_key:"tableItemSelectionRef",ref:d,"table-data":C.value,"table-title":P.value},null,8,["loading","table-data","table-title"])]),_:1})]),_:1}),o(n(j),{visible:c.value,"onUpdate:visible":t[1]||(t[1]=v=>c.value=v),title:n(B),width:"60%","destroy-on-close":""},{default:p(()=>[g("div",null,[o(n(q),{"form-items":E.value,form:a,rules:e.formRules,ref_key:"customFormref",ref:w},null,8,["form-items","form","rules"]),g("div",ee,[o(m,{type:"primary",onClick:V},{default:p(()=>[f("确定")]),_:1})])])]),_:1},8,["visible","title"])])}}};export{ze as default};

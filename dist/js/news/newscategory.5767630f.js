import{D as q}from"../index/index.78072cb3.js";import{D as P}from"../index/index.41c9881b.js";import{M as R,B as S,P as z}from"../@element-plus/@element-plus.01e950e2.js";import{g as A,a as G,d as H,e as J,u as K,b as O}from"../newCategory/newCategory.d8bef9d4.js";import{D as Q}from"../index/index.aae611ba.js";import{f as W}from"../fomattime/fomattime.dd6f399c.js";import{e as r,x as X,k as N,l as D,c as Y,a4 as a,_ as p,u as n,an as o,a2 as f,o as Z,a as g}from"../@vue/@vue.133e0034.js";import{l as i}from"../element-plus/element-plus.8d403dde.js";import"../../assets/index-30bdac58.js";import"../pinia/pinia.dbd2d364.js";import"../js-cookie/js-cookie.cf83ad76.js";import"../axios/axios.aba6f0e0.js";import"../geotiff/geotiff.41c905a7.js";import"../vue-router/vue-router.aebc008a.js";import"../fuse.js/fuse.js.88e2763d.js";import"../path-browserify/path-browserify.188d1ff8.js";import"../screenfull/screenfull.b3e6dc1f.js";import"../mitt/mitt.f7ef348c.js";import"../lodash-es/lodash-es.3689fb67.js";import"../@vueuse/@vueuse.902d2a47.js";import"../@ctrl/@ctrl.739734d8.js";import"../nprogress/nprogress.71449f25.js";/* empty css                                 */import"../clipboard/clipboard.860bb701.js";import"../vue-i18n/vue-i18n.dbf743d6.js";import"../@intlify/@intlify.771bffe6.js";import"../xe-utils/xe-utils.ae8f073f.js";import"../vxe-table/vxe-table.548b57f4.js";import"../vue3-lottie/vue3-lottie.24ecfee7.js";import"../lottie-web/lottie-web.c7050559.js";import"../@popperjs/@popperjs.d5d3bfa4.js";import"../dayjs/dayjs.aab16a72.js";import"../async-validator/async-validator.124ce023.js";import"../memoize-one/memoize-one.e2e9ba7a.js";import"../escape-html/escape-html.1d60d822.js";import"../normalize-wheel-es/normalize-wheel-es.2d7fa0bb.js";import"../@floating-ui/@floating-ui.c244c5cb.js";import"../vue/vue.b7c74ca4.js";import"../lodash-unified/lodash-unified.917db8bb.js";import"./news.8f1b56e5.js";const $={class:"common-layout"},ee={class:"flex-row"},te={class:"flex justify-end"},Ge={__name:"newscategory",setup(ae,{expose:F}){const _=r(!1);X(()=>{m()});const M=N(()=>l.id?"修改分类":"添加分类"),l=D({name:"",description:""}),B=r([{prop:"name",label:"分类名称",rules:[{required:!0,message:"必须输入分类名称",trigger:"blur"}]},{prop:"description",label:"备注",type:"textarea"}]),c=r(!1),m=async()=>{_.value=!0;const{data:e}=await A(y);_.value=!1,w.value=e},w=r([]),d=r(null),C=N(()=>{var e;return((e=d==null?void 0:d.value)==null?void 0:e.multipleSelection)||[]}),E=r([{type:"selection"},{prop:"id",label:"ID",width:80},{prop:"name",label:"标题"},{prop:"state",label:"状态",render:e=>a("div",null,[e.state==1?"启用":"禁用"])},{prop:"created_time",label:"创建日期",render:e=>a("div",null,[W(e.created_time)])},{prop:"setting",label:"操作",render:e=>a("div",{class:"flex"},[a(o("el-button"),{type:"primary",onClick:()=>T(e)},{default:()=>[f("编辑")]}),e.state==1?a(o("el-button"),{type:"warning",onClick:()=>x(e)},{default:()=>[f("禁用")]}):a(o("el-button"),{type:"success",onClick:()=>x(e)},{default:()=>[f("启用")]}),a(o("el-button"),{type:"danger",onClick:()=>k(e)},{default:()=>[f("删除")]})])}]),h=r(""),V=async()=>{if(await h.value.form.validate())if(l.id){const t=await K(l);t.data&&(i.ElMessage({message:t.msg,type:"success"}),c.value=!1,m())}else{const t=await O(l);t.data?(i.ElMessage({message:t.msg,type:"success"}),c.value=!1,m()):i.ElMessage.error(t.msg)}},T=async e=>{const t=await G({id:e.id}),{id:s,name:u,description:b}=t.data;l.id=s,l.name=u,l.description=b,c.value=!0},k=e=>{const t=C.value.length>0?C.value.map(s=>s.id):[e.id];if(t.length==0||t[t.length-1]==null){i.ElMessage.warning("至少选中一条数据");return}i.ElMessageBox.confirm("确定要删除这些选中分类吗吗",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{(await H({ids:t})).code==200&&(i.ElMessage({type:"success",message:"删除成功"}),m())})},y=D({search:""}),x=async e=>{const{id:t}=e,s=await J({id:t});s.data&&(i.ElMessage({type:"success",message:s.msg}),m())},I=()=>{c.value=!0};return F({tableItemSelectionRef:d}),(e,t)=>{const s=o("el-input"),u=o("el-button"),b=o("el-row"),L=o("el-header"),U=o("el-main"),j=o("el-container");return Z(),Y("div",$,[a(j,null,{default:p(()=>[a(L,{class:"h-auto"},{default:p(()=>[a(b,{class:"flex-row flex-between"},{default:p(()=>[g("div",ee,[a(s,{class:"w-50",modelValue:y.search,"onUpdate:modelValue":t[0]||(t[0]=v=>y.search=v),placeholder:"输入标题"},null,8,["modelValue"]),a(u,{class:"ml-2",icon:n(R),circle:"",onClick:m},null,8,["icon"])]),g("div",null,[a(u,{type:"primary",icon:n(S),circle:"",onClick:I},null,8,["icon"]),a(u,{type:"danger",icon:n(z),circle:"",onClick:k},null,8,["icon"])])]),_:1})]),_:1}),a(U,null,{default:p(()=>[a(n(Q),{loading:_.value,ref_key:"tableItemSelectionRef",ref:d,"table-data":w.value,"table-title":E.value},null,8,["loading","table-data","table-title"])]),_:1})]),_:1}),a(n(q),{visible:c.value,"onUpdate:visible":t[1]||(t[1]=v=>c.value=v),title:n(M),width:"60%","destroy-on-close":""},{default:p(()=>[g("div",null,[a(n(P),{"form-items":B.value,form:l,rules:e.formRules,ref_key:"customFormref",ref:h},null,8,["form-items","form","rules"]),g("div",te,[a(u,{type:"primary",onClick:V},{default:p(()=>[f("确定")]),_:1})])])]),_:1},8,["visible","title"])])}}};export{Ge as default};

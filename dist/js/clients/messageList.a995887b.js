import{M as T,B as E}from"../@element-plus/@element-plus.01e950e2.js";import{h as z}from"../../assets/index-30bdac58.js";import{c as I}from"../productsCategory/productsCategory.4a144398.js";import{D as q}from"../index/index.aae611ba.js";import{e as c,x as A,l as b,k as F,c as j,a4 as a,_ as m,an as o,a2 as N,o as k,a as w,u as v,Z,a1 as G}from"../@vue/@vue.133e0034.js";import{l as y}from"../element-plus/element-plus.8d403dde.js";import"../@ctrl/@ctrl.739734d8.js";import"../pinia/pinia.dbd2d364.js";import"../js-cookie/js-cookie.cf83ad76.js";import"../axios/axios.aba6f0e0.js";import"../geotiff/geotiff.41c905a7.js";import"../vue-router/vue-router.aebc008a.js";import"../fuse.js/fuse.js.88e2763d.js";import"../path-browserify/path-browserify.188d1ff8.js";import"../screenfull/screenfull.b3e6dc1f.js";import"../mitt/mitt.f7ef348c.js";import"../lodash-es/lodash-es.3689fb67.js";import"../@vueuse/@vueuse.902d2a47.js";import"../nprogress/nprogress.71449f25.js";/* empty css                                 */import"../clipboard/clipboard.860bb701.js";import"../vue-i18n/vue-i18n.dbf743d6.js";import"../@intlify/@intlify.771bffe6.js";import"../xe-utils/xe-utils.ae8f073f.js";import"../vxe-table/vxe-table.548b57f4.js";import"../vue3-lottie/vue3-lottie.24ecfee7.js";import"../lottie-web/lottie-web.c7050559.js";import"../@popperjs/@popperjs.d5d3bfa4.js";import"../dayjs/dayjs.aab16a72.js";import"../async-validator/async-validator.124ce023.js";import"../memoize-one/memoize-one.e2e9ba7a.js";import"../escape-html/escape-html.1d60d822.js";import"../normalize-wheel-es/normalize-wheel-es.2d7fa0bb.js";import"../@floating-ui/@floating-ui.c244c5cb.js";import"../vue/vue.b7c74ca4.js";import"../lodash-unified/lodash-unified.917db8bb.js";function H(u){return z.request({method:"get",url:"/contactUs/getContactUsList",data:u})}function J(u){return z.request({method:"post",url:"/contactUs/addClientSea",data:u})}const K={class:"common-layout"},O={class:"flex-row"},Me={__name:"messageList",setup(u,{expose:B}){const d=c(!1);A(()=>{r(),M()});const g=c(""),P=b({list:[]}),D=b({list:[],label:"name",value:"id"}),M=async()=>{const{data:e}=await I();P.list=e,D.list=e},r=async()=>{d.value=!0;const{data:e}=await H(l);console.log(e),d.value=!1,C.value=e.data,g.value=e.total},C=c([]),i=c(null),h=F(()=>{var e;return((e=i==null?void 0:i.value)==null?void 0:e.multipleSelection)||[]}),U=c([{type:"selection"},{prop:"id",label:"ID",width:80},{prop:"name",label:"姓名"},{prop:"interestedProducts",label:"意向产品",render:e=>{if(e.interestedProducts){const t=e.productName.split(","),s=e.CategoriesNames.split(",");return t.map((n,f)=>({productName:n.trim(),CategoriesNames:s[f].trim()})).map(n=>a(o("el-badge"),{"is-dot":!0,class:"badgeMg"},{default:()=>[n.CategoriesNames,N(":"),n.productName]}))}}},{prop:"messageContent",label:"留言内容"},{prop:"phone",label:"联系电话"},{prop:"email",label:"邮箱号码"},{prop:"created_at",label:"留言日期"},{prop:"companyName",label:"公司名称"},{prop:"fax",label:"传真号码"},{prop:"ip",label:"网络IP归属"},{prop:"setting",label:"操作",render:e=>a("div",{class:"flex"},[a(o("el-button"),{type:"primary",onClick:()=>x(e)},{default:()=>[N("加入客户公海")]})])}]),l=b({search:"",pagesize:10,currentPage:1}),x=async e=>{const t=h.value.length!=0?h.value.map(s=>s.id):e.id?[e.id]:[];if(t.length==0)return y.ElMessage.warning("至少选中一条数据"),!1;y.ElMessageBox.confirm("确定把这个留言客户移入到客户公海?","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const s=await J({messageIds:t});y.ElMessage({type:"success",message:s.msg}),r()}).catch(()=>{})};return B({tableItemSelectionRef:i}),(e,t)=>{const s=o("el-input"),_=o("el-button"),n=o("el-row"),f=o("el-header"),V=o("el-pagination"),S=o("el-main"),L=o("el-container");return k(),j("div",K,[a(L,null,{default:m(()=>[a(f,{class:"h-auto"},{default:m(()=>[a(n,{class:"flex-row flex-between"},{default:m(()=>[w("div",O,[a(s,{modelValue:l.search,"onUpdate:modelValue":t[0]||(t[0]=p=>l.search=p),placeholder:"名称/公司/留言内容/电话/邮箱"},null,8,["modelValue"]),a(_,{class:"ml-2",icon:v(T),circle:"",onClick:r},null,8,["icon"])]),w("div",null,[a(_,{type:"primary",icon:v(E),circle:"",onClick:x},null,8,["icon"])])]),_:1})]),_:1}),a(S,null,{default:m(()=>[a(v(q),{loading:d.value,ref_key:"tableItemSelectionRef",ref:i,"table-data":C.value,"table-title":U.value},null,8,["loading","table-data","table-title"]),g.value>10?(k(),Z(V,{key:0,class:"flex justify-end","current-page":l.currentPage,"onUpdate:currentPage":t[1]||(t[1]=p=>l.currentPage=p),"page-size":l.pagesize,"onUpdate:pageSize":t[2]||(t[2]=p=>l.pagesize=p),background:!0,"page-sizes":[10,25,50,100],layout:"total,sizes, prev, pager, next",total:g.value,onSizeChange:r,onCurrentChange:r},null,8,["current-page","page-size","total"])):G("",!0)]),_:1})]),_:1})])}}};export{Me as default};
